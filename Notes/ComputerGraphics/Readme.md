<!--
 * @Author: LetMeFly
 * @Date: 2021-12-19 12:28:54
 * @LastEditors: LetMeFly
 * @LastEditTime: 2021-12-19 16:07:40
-->
# 计算机图形学

### 直线的扫描转换

#### 数值微分法 <small>*DDA line algorithm*</small>

对于斜率的绝对值小于1的直线，从左端点P0(x0,y0)开始，x每增加1，y就增加k

```cpp
void DDA(int x0, int y0, int x1, int y1) {
    float k = 1. * (y1 - y0) / (x1 - x0);
    for (; x0 <= x1; x0++) {
        drawPixel(x0, y0);
        y0 += k;
    }
}
```

#### 中点画线法 <small>*Midpoint line algorithm*</small>

直线上点(x, y)满足**F(x, y) = ax + by + c = 0**（其中a = y0 - y1，b = x1 - x0，c = x0y1 - x1y0），直线下方的点算得F(x, y) < 0，直线上方的点算得F(x, y) > 0。

斜率在0\~1的曲线，x每增加1，y会增加1或不变。
<center><img src="data:image/jpeg;base64,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"></center>
在确定好点(xp, yp)的位置后，要确定这个点右边的点是P1(xp + 1, yp)还是P2(xp + 1, yp + 1)，可以取P1和P2的中点M(xp + 1, yp + 0.5)，看F(M)的正负。

> + 如果F(M) < 0，说明点M在直线的下方，因此直线距点P2更近。
> + 如果F(M) > 0，说明直线距离点P1更进近。
> + 如果F(M) = 0，则M正好在直线上，人为规定此时选取P1（和>0时相同）

```cpp
void Midpoint(int x0, int y0, int x1, int y1) {
    int a = y0 - y1, b = x1 - x0, c = x0 * y1 - x1 * y0;
    for (; x0 <= x1; x0++) {
        float f = a * x0 + b * (y0 + 0.5) + c;
        if (f < 0) y0++;
        drawPixel(x0, y0);
    }
}
```

接下来我们优化f的计算：其实新的f可以通过上次的f求得。

设当前我们画了点L1，接下来该画点L2（L2是L1右边相邻的点）。记(xl1, yl1 + 0.5)为M1，记(xl2, yl2 + 0.5)为M2，记F(M1)为f1，记F(M2)为f2。
则f1 = a * xm1 + b * ym1 + c, f2 = a * xm2 + b * ym2 + c。
∴f2 - f1 = a * (xm2 - xm1) + b * (ym2 - ym1)
∴f2 = f1 + a * (xm2 - xm1) + b * (ym2 - ym1)

因为m2是m1右边的下一个点，所以xm2 - xm1 = 1
而ym2 - ym1 = 1 或 0
当m2是m1右上方的点时，ym2 - ym1 = 1，此时f1 < 0，f2 = f1 + a
当m2是m1正右边的点时，ym2 - ym1 = 0，此时f1 ≥ 0，f2 = f1 + a + b

通过以上方法我们即可用前一个点的f值求得后一个点的f值，初始值f0 = F(x0, y + 0.5) = a + 0.5b

```cpp
void midPoint(int x0, int y0, int x1, int y1) {
    int a = y0 - y1, b = x1 - x0;
    float f = a + 0.5 * b; // 斜率在0~1，∴f > 0，符合初始条件中点在直线上方
    for (; x0 <= x1; x0++) {
        if (f < 0) y0++, f += a;
        else f += a + b;
        drawPixel(x0, y0);
    }
}
```

每次f的增量都是整数，只有初始值的时候f = a + 0.5 * b 可能为小数。
因此我们可以令F(x, y) = 2 * a * x + 2 * b * y + 2 * c，这样就避免了小数问题。

```cpp
void midPoint(int x0, int y0, int x1, int y1) {
    int a = y0 - y1, b = x1 - x0;
    int f = 2 * a + b; // 此处就可以改为int了
    for (; x0 <= x1; x0++) {
        if (f < 0) y0++, f += 2 * a;
        else f += 2 * (a + b);
        drawPixel(x0, y0);
    }
}
```

#### Bresenham算法 <small>*Bresenham's line algorithm*</small>

记直线方程为y=kx+b。

<center><img src="data:image/jpeg;base64,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"></center>

误差项d初始值为0，x每增加1，d就增加k
当d ≥ 1 时，就让 d 减一，保证d在0~1之间

> + 如果 d ≥ 0.5，那么应该取下方的点
> + 如果 d < 0.5，那么应该取上方的点

小改进：
令 e = d - 0.5，则e的范围是[-0.5, 0.5)，初始值-0.5，e ≥ 0.5时减一，判断e的正负来判断取上方的点还是下方的点。

```cpp
void bresenham(int x0, int y0, int x1, int y1) {
    float k = (y1 - y0) / (x1 - x0);
    float e = -0.5;
    for (; x0 <= x1; x0++) {
        drawPixel(x0, y0);
        e += k;
        if (e >= 0) e -= 1, y0++;
    }
}
```

改进：
上述运算中同样用到了小数。但不难发现e的判断只与符号有关。
因此我们可以让 e' = 2 * dx * e，则初始值e' = -0.5 * 2 * dx = -dx，e'每次加上2 * dx * k = 2 * dy，e' ≥ 0 时应减去1 * 2 * dx = 2 * dx。

```cpp
void bresenham(int x0, int y0, int x1, int y1) {
    int dx = x1 - x0;
    int e = -dx;
    for (; x0 <= x1; x0++) {
        drawPixel(x0, y0);
        e += 2 * dy;
        if (e >= 0) e -= 2 * dx, y0++;
    }
}
```
