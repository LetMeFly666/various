
<!-- saved from url=(0071)http://acm.hdu.edu.cn/contests/contest_showproblem.php?pid=1007&cid=880 -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=GBK"><meta name="keywords" content="HDOJ ACM ICPC OJ C C++ Pascal Java"><script src="HTML-Files/global.js" type="text/javascript"></script><script src="HTML-Files/MathJax.js" type="text/javascript"></script><link rel="stylesheet" href="HTML-Files/global.css" type="text/css"><title>Problem - 1007</title><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Hover_Arrow {position: absolute; width: 15px; height: 11px; cursor: pointer}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('http://acm.hdu.edu.cn/js/MathJax/MathJax/../fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://acm.hdu.edu.cn/js/MathJax/MathJax/../fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('http://acm.hdu.edu.cn/js/MathJax/MathJax/../fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?rev=2.4-beta-2') format('woff'), url('http://acm.hdu.edu.cn/js/MathJax/MathJax/../fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('http://acm.hdu.edu.cn/js/MathJax/MathJax/../fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?rev=2.4-beta-2') format('woff'), url('http://acm.hdu.edu.cn/js/MathJax/MathJax/../fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('http://acm.hdu.edu.cn/js/MathJax/MathJax/../fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?rev=2.4-beta-2') format('woff'), url('http://acm.hdu.edu.cn/js/MathJax/MathJax/../fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('http://acm.hdu.edu.cn/js/MathJax/MathJax/../fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://acm.hdu.edu.cn/js/MathJax/MathJax/../fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('http://acm.hdu.edu.cn/js/MathJax/MathJax/../fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://acm.hdu.edu.cn/js/MathJax/MathJax/../fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('http://acm.hdu.edu.cn/js/MathJax/MathJax/../fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://acm.hdu.edu.cn/js/MathJax/MathJax/../fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('http://acm.hdu.edu.cn/js/MathJax/MathJax/../fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://acm.hdu.edu.cn/js/MathJax/MathJax/../fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?rev=2.4-beta-2') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('http://acm.hdu.edu.cn/js/MathJax/MathJax/../fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?rev=2.4-beta-2') format('woff'), url('http://acm.hdu.edu.cn/js/MathJax/MathJax/../fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?rev=2.4-beta-2') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; color: #666666}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_Menu_Close {position: absolute; width: 31px; height: 31px; top: -15px; left: -15px}
</style></head>
<!--Added a "STD Contest" button by zhengfeng  2010-08-09-->
<body><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div><a name="top"></a><center>
<div id="contest_nav" align="center">
	<a href="http://acm.hdu.edu.cn/" style="margin:0"><img src="http://acm.hdu.edu.cn/images/banner.jpg" width="980" height="116"></a>
	<a href="http://acm.hdu.edu.cn/" style="margin-left:3px">Home</a>
	<a href="http://acm.hdu.edu.cn/contests/contest_list.php?cid=880" style="margin-left:3px">STD Contest</a>
	<a href="http://acm.hdu.edu.cn/notification.php?cid=880" style="margin-left:3px">Notification</a>
	<a href="http://acm.hdu.edu.cn/contests/contest_listtopic.php?cid=880&amp;page=1" style="margin-left:3px">Clarification</a>
	<a href="http://acm.hdu.edu.cn/contests/contest_show.php?cid=880" style="margin-left:3px">Problems</a>
	<a href="http://acm.hdu.edu.cn/contests/contest_ranklist.php?cid=880&amp;page=1" style="margin-left:3px">Ranklist</a>
	<a href="http://acm.hdu.edu.cn/contests/contest_status.php?cid=880" style="margin-left:3px">Status</a>
	<!--<a href="/contests/contest_statistic.php?cid=880" style="margin-left:3px">Statistics</a>-->
	<a href="http://acm.hdu.edu.cn/contests/contest_showproblem.php?pid=1007&amp;cid=880#" style="margin-left:3px"><font color="gray">Statistics</font></a>
	<a href="http://acm.hdu.edu.cn/contests/contest_print.php?cid=880" style="margin-left:3px;margin-right:0px">Print</a>
</div>
<div style="width:980px;padding:0;margin:0"><h1 style="color:#1A5CC8;margin-top: 20px">In Search of Gold</h1><font face="Arial"><b><span style="font-size:12px;color:green">Time Limit: 4000/4000 MS (Java/Others)&nbsp;&nbsp;&nbsp;&nbsp;Memory Limit: 524288/524288 K (Java/Others)<br>Total Submission(s): 257&nbsp;&nbsp;&nbsp;&nbsp;Accepted Submission(s): 59<br></span></b></font><br><br><div class="panel_title" align="left">Problem Description</div><div class="panel_content">Sunset got a map about an abandoned gold mine in the border town. The map shows that the gold mine consists of <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-1-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-1" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.807em, 1000em, 2.639em, -0.621em); top: -2.424em; left: 0.003em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.431em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.646em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-1">n</script> rooms connected by <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-2-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-4" style="width: 2.361em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.292em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.807em, 1000em, 2.916em, -0.621em); top: -2.701em; left: 0.003em;"><span class="mrow" id="MathJax-Span-5"><span class="mi" id="MathJax-Span-6" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-7" style="font-family: MathJax_Main; padding-left: 0.212em;">&#8722;</span><span class="mn" id="MathJax-Span-8" style="font-family: MathJax_Main; padding-left: 0.212em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.708em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.861em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-2">n-1</script> bidirectional tunnels, forming a tree structure. The map is so strange that on the <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-3-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-9" style="width: 0.35em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.35em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.529em, 1000em, 2.639em, -0.621em); top: -2.424em; left: 0.003em;"><span class="mrow" id="MathJax-Span-10"><span class="mi" id="MathJax-Span-11" style="font-family: MathJax_Math-italic;">i</span></span><span style="display: inline-block; width: 0px; height: 2.431em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.861em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-3">i</script>-th tunnel, there are two numbers <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-4-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-12" style="width: 0.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.905em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.35em, 1000em, 1.321em, -0.621em); top: -0.967em; left: 0.003em;"><span class="mrow" id="MathJax-Span-13"><span class="msubsup" id="MathJax-Span-14"><span style="display: inline-block; position: relative; width: 0.905em; height: 0px;"><span style="position: absolute; clip: rect(1.807em, 1000em, 2.639em, -0.621em); top: -2.424em; left: 0.003em;"><span class="mi" id="MathJax-Span-15" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.431em;"></span></span><span style="position: absolute; top: -1.869em; left: 0.558em;"><span class="mi" id="MathJax-Span-16" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.015em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.974em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.789em; vertical-align: -0.211em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-4">a_i</script> and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-5-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-17" style="width: 0.905em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.073em, 1000em, 1.321em, -0.551em); top: -0.967em; left: 0.003em;"><span class="mrow" id="MathJax-Span-18"><span class="msubsup" id="MathJax-Span-19"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(1.529em, 1000em, 2.639em, -0.551em); top: -2.424em; left: 0.003em;"><span class="mi" id="MathJax-Span-20" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 2.431em;"></span></span><span style="position: absolute; top: -1.869em; left: 0.489em;"><span class="mi" id="MathJax-Span-21" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.015em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.974em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.211em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-5">b_i</script>. The only thing Sunset knows is that there are exactly <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-6-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-22" style="width: 0.489em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.489em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.529em, 1000em, 2.639em, -0.551em); top: -2.424em; left: 0.003em;"><span class="mrow" id="MathJax-Span-23"><span class="mi" id="MathJax-Span-24" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.431em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.861em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-6">k</script> tunnels whose lengths are taken from <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-7-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-25" style="width: 0.558em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.558em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.807em, 1000em, 2.639em, -0.621em); top: -2.424em; left: 0.003em;"><span class="mrow" id="MathJax-Span-26"><span class="mi" id="MathJax-Span-27" style="font-family: MathJax_Math-italic;">a</span></span><span style="display: inline-block; width: 0px; height: 2.431em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.646em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-7">a</script> while the lengths of other <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-8-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-28" style="width: 4.164em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.026em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.807em, 1000em, 2.916em, -0.621em); top: -2.701em; left: 0.003em;"><span class="mrow" id="MathJax-Span-29"><span class="mi" id="MathJax-Span-30" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-31" style="font-family: MathJax_Main; padding-left: 0.212em;">&#8722;</span><span class="mi" id="MathJax-Span-32" style="font-family: MathJax_Math-italic; padding-left: 0.212em;">k</span><span class="mo" id="MathJax-Span-33" style="font-family: MathJax_Main; padding-left: 0.212em;">&#8722;</span><span class="mn" id="MathJax-Span-34" style="font-family: MathJax_Main; padding-left: 0.212em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.708em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.861em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-8">n-k-1</script> tunnels are taken from <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-9-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-35" style="width: 0.489em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.489em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.529em, 1000em, 2.639em, -0.551em); top: -2.424em; left: 0.003em;"><span class="mrow" id="MathJax-Span-36"><span class="mi" id="MathJax-Span-37" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.431em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.861em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-9">b</script>.<br><br>Tomorrow Sunset will explore that gold mine. He is afraid of getting lost in the gold mine, so can you please tell him the diameter of the gold mine if he is lucky enough? In other words, please calculate the minimum possible length of the diameter from the information Sunset has.</div><div class="panel_bottom">&nbsp;</div><br><div class="panel_title" align="left">Input</div><div class="panel_content">The first line of the input contains a single integer <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-10-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-38" style="width: 0.766em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.697em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.529em, 1000em, 2.639em, -0.621em); top: -2.424em; left: 0.003em;"><span class="mrow" id="MathJax-Span-39"><span class="mi" id="MathJax-Span-40" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.142em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.431em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.861em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-10">T</script> (<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-11-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-41" style="width: 6.8em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.592em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.807em, 1000em, 3.055em, -0.551em); top: -2.701em; left: 0.003em;"><span class="mrow" id="MathJax-Span-42"><span class="mn" id="MathJax-Span-43" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-44" style="font-family: MathJax_Main; padding-left: 0.281em;">¡Ü</span><span class="mi" id="MathJax-Span-45" style="font-family: MathJax_Math-italic; padding-left: 0.281em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.142em;"></span></span><span class="mo" id="MathJax-Span-46" style="font-family: MathJax_Main; padding-left: 0.281em;">¡Ü</span><span class="mn" id="MathJax-Span-47" style="font-family: MathJax_Main; padding-left: 0.281em;">10</span><span class="mspace" id="MathJax-Span-48" style="height: 0.003em; vertical-align: 0.003em; width: 0.142em; display: inline-block; overflow: hidden;"></span><span class="mn" id="MathJax-Span-49" style="font-family: MathJax_Main;">000</span></span><span style="display: inline-block; width: 0px; height: 2.708em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.211em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-11">1 \leq T \leq 10\,000</script>), the number of test cases.<br><br>For each case, the first line of the input contains two integers <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-12-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-50" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.807em, 1000em, 2.639em, -0.621em); top: -2.424em; left: 0.003em;"><span class="mrow" id="MathJax-Span-51"><span class="mi" id="MathJax-Span-52" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.431em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.646em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-12">n</script> and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-13-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-53" style="width: 0.489em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.489em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.529em, 1000em, 2.639em, -0.551em); top: -2.424em; left: 0.003em;"><span class="mrow" id="MathJax-Span-54"><span class="mi" id="MathJax-Span-55" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.431em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.861em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-13">k</script> (<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-14-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-56" style="width: 6.592em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.383em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.807em, 1000em, 3.055em, -0.551em); top: -2.701em; left: 0.003em;"><span class="mrow" id="MathJax-Span-57"><span class="mn" id="MathJax-Span-58" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-59" style="font-family: MathJax_Main; padding-left: 0.281em;">¡Ü</span><span class="mi" id="MathJax-Span-60" style="font-family: MathJax_Math-italic; padding-left: 0.281em;">n</span><span class="mo" id="MathJax-Span-61" style="font-family: MathJax_Main; padding-left: 0.281em;">¡Ü</span><span class="mn" id="MathJax-Span-62" style="font-family: MathJax_Main; padding-left: 0.281em;">20</span><span class="mspace" id="MathJax-Span-63" style="height: 0.003em; vertical-align: 0.003em; width: 0.142em; display: inline-block; overflow: hidden;"></span><span class="mn" id="MathJax-Span-64" style="font-family: MathJax_Main;">000</span></span><span style="display: inline-block; width: 0px; height: 2.708em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.211em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-14">2 \leq n \leq 20\,000</script>, <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-15-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-65" style="width: 6.245em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.037em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.807em, 1000em, 3.055em, -0.551em); top: -2.701em; left: 0.003em;"><span class="mrow" id="MathJax-Span-66"><span class="mn" id="MathJax-Span-67" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-68" style="font-family: MathJax_Main; padding-left: 0.281em;">¡Ü</span><span class="mi" id="MathJax-Span-69" style="font-family: MathJax_Math-italic; padding-left: 0.281em;">k</span><span class="mo" id="MathJax-Span-70" style="font-family: MathJax_Main; padding-left: 0.281em;">¡Ü</span><span class="mi" id="MathJax-Span-71" style="font-family: MathJax_Math-italic; padding-left: 0.281em;">n</span><span class="mo" id="MathJax-Span-72" style="font-family: MathJax_Main; padding-left: 0.212em;">&#8722;</span><span class="mn" id="MathJax-Span-73" style="font-family: MathJax_Main; padding-left: 0.212em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.708em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.211em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-15">0\leq k\leq n-1</script>, <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-16-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-74" style="width: 2.916em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.847em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.807em, 1000em, 3.055em, -0.551em); top: -2.701em; left: 0.003em;"><span class="mrow" id="MathJax-Span-75"><span class="mi" id="MathJax-Span-76" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-77" style="font-family: MathJax_Main; padding-left: 0.281em;">¡Ü</span><span class="mn" id="MathJax-Span-78" style="font-family: MathJax_Main; padding-left: 0.281em;">20</span></span><span style="display: inline-block; width: 0px; height: 2.708em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.211em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-16">k\leq 20</script>), denoting the number of rooms and the parameter <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-17-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-79" style="width: 0.489em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.489em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.529em, 1000em, 2.639em, -0.551em); top: -2.424em; left: 0.003em;"><span class="mrow" id="MathJax-Span-80"><span class="mi" id="MathJax-Span-81" style="font-family: MathJax_Math-italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.431em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.861em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-17">k</script>.<br><br>Each of the following <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-18-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-82" style="width: 2.361em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.292em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.807em, 1000em, 2.916em, -0.621em); top: -2.701em; left: 0.003em;"><span class="mrow" id="MathJax-Span-83"><span class="mi" id="MathJax-Span-84" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-85" style="font-family: MathJax_Main; padding-left: 0.212em;">&#8722;</span><span class="mn" id="MathJax-Span-86" style="font-family: MathJax_Main; padding-left: 0.212em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.708em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.861em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-18">n-1</script> lines contains four integers <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-19-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-87" style="width: 3.61em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.471em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(2.084em, 1000em, 3.124em, -0.621em); top: -2.701em; left: 0.003em;"><span class="mrow" id="MathJax-Span-88"><span class="msubsup" id="MathJax-Span-89"><span style="display: inline-block; position: relative; width: 0.905em; height: 0px;"><span style="position: absolute; clip: rect(1.807em, 1000em, 2.639em, -0.621em); top: -2.424em; left: 0.003em;"><span class="mi" id="MathJax-Span-90" style="font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 2.431em;"></span></span><span style="position: absolute; top: -1.869em; left: 0.558em;"><span class="mi" id="MathJax-Span-91" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.015em;"></span></span></span></span><span class="mo" id="MathJax-Span-92" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-93" style="padding-left: 0.142em;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(1.807em, 1000em, 2.639em, -0.621em); top: -2.424em; left: 0.003em;"><span class="mi" id="MathJax-Span-94" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 2.431em;"></span></span><span style="position: absolute; top: -1.869em; left: 0.489em;"><span class="mi" id="MathJax-Span-95" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.015em;"></span></span></span></span><span class="mo" id="MathJax-Span-96" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-97" style="padding-left: 0.142em;"><span style="display: inline-block; position: relative; width: 0.905em; height: 0px;"><span style="position: absolute; clip: rect(1.807em, 1000em, 2.639em, -0.621em); top: -2.424em; left: 0.003em;"><span class="mi" id="MathJax-Span-98" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.431em;"></span></span><span style="position: absolute; top: -1.869em; left: 0.558em;"><span class="mi" id="MathJax-Span-99" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.015em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.708em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.789em; vertical-align: -0.282em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-19">u_i,v_i,a_i</script> and <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-20-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-100" style="width: 0.905em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.073em, 1000em, 1.321em, -0.551em); top: -0.967em; left: 0.003em;"><span class="mrow" id="MathJax-Span-101"><span class="msubsup" id="MathJax-Span-102"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(1.529em, 1000em, 2.639em, -0.551em); top: -2.424em; left: 0.003em;"><span class="mi" id="MathJax-Span-103" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 2.431em;"></span></span><span style="position: absolute; top: -1.869em; left: 0.489em;"><span class="mi" id="MathJax-Span-104" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.015em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.974em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.211em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-20">b_i</script> (<span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-21-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-105" style="width: 6.175em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.967em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.807em, 1000em, 3.124em, -0.551em); top: -2.701em; left: 0.003em;"><span class="mrow" id="MathJax-Span-106"><span class="mn" id="MathJax-Span-107" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-108" style="font-family: MathJax_Main; padding-left: 0.281em;">¡Ü</span><span class="msubsup" id="MathJax-Span-109" style="padding-left: 0.281em;"><span style="display: inline-block; position: relative; width: 0.905em; height: 0px;"><span style="position: absolute; clip: rect(1.807em, 1000em, 2.639em, -0.621em); top: -2.424em; left: 0.003em;"><span class="mi" id="MathJax-Span-110" style="font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 2.431em;"></span></span><span style="position: absolute; top: -1.869em; left: 0.558em;"><span class="mi" id="MathJax-Span-111" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.015em;"></span></span></span></span><span class="mo" id="MathJax-Span-112" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-113" style="padding-left: 0.142em;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(1.807em, 1000em, 2.639em, -0.621em); top: -2.424em; left: 0.003em;"><span class="mi" id="MathJax-Span-114" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 2.431em;"></span></span><span style="position: absolute; top: -1.869em; left: 0.489em;"><span class="mi" id="MathJax-Span-115" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.015em;"></span></span></span></span><span class="mo" id="MathJax-Span-116" style="font-family: MathJax_Main; padding-left: 0.281em;">¡Ü</span><span class="mi" id="MathJax-Span-117" style="font-family: MathJax_Math-italic; padding-left: 0.281em;">n</span></span><span style="display: inline-block; width: 0px; height: 2.708em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.282em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-21">1\leq u_i,v_i\leq n</script>, <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-22-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-118" style="width: 3.193em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.055em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.807em, 1000em, 3.124em, -0.621em); top: -2.701em; left: 0.003em;"><span class="mrow" id="MathJax-Span-119"><span class="msubsup" id="MathJax-Span-120"><span style="display: inline-block; position: relative; width: 0.905em; height: 0px;"><span style="position: absolute; clip: rect(1.807em, 1000em, 2.639em, -0.621em); top: -2.424em; left: 0.003em;"><span class="mi" id="MathJax-Span-121" style="font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 2.431em;"></span></span><span style="position: absolute; top: -1.869em; left: 0.558em;"><span class="mi" id="MathJax-Span-122" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.015em;"></span></span></span></span><span class="mo" id="MathJax-Span-123" style="font-family: MathJax_Main; padding-left: 0.281em;">¡Ù</span><span class="msubsup" id="MathJax-Span-124" style="padding-left: 0.281em;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(1.807em, 1000em, 2.639em, -0.621em); top: -2.424em; left: 0.003em;"><span class="mi" id="MathJax-Span-125" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 2.431em;"></span></span><span style="position: absolute; top: -1.869em; left: 0.489em;"><span class="mi" id="MathJax-Span-126" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.015em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.708em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.075em; vertical-align: -0.282em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-22">u_i\neq v_i</script>, <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-23-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-127" style="width: 7.008em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.8em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.668em, 1000em, 3.124em, -0.551em); top: -2.701em; left: 0.003em;"><span class="mrow" id="MathJax-Span-128"><span class="mn" id="MathJax-Span-129" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-130" style="font-family: MathJax_Main; padding-left: 0.281em;">¡Ü</span><span class="msubsup" id="MathJax-Span-131" style="padding-left: 0.281em;"><span style="display: inline-block; position: relative; width: 0.905em; height: 0px;"><span style="position: absolute; clip: rect(1.807em, 1000em, 2.639em, -0.621em); top: -2.424em; left: 0.003em;"><span class="mi" id="MathJax-Span-132" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.431em;"></span></span><span style="position: absolute; top: -1.869em; left: 0.558em;"><span class="mi" id="MathJax-Span-133" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.015em;"></span></span></span></span><span class="mo" id="MathJax-Span-134" style="font-family: MathJax_Main;">,</span><span class="msubsup" id="MathJax-Span-135" style="padding-left: 0.142em;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(1.529em, 1000em, 2.639em, -0.551em); top: -2.424em; left: 0.003em;"><span class="mi" id="MathJax-Span-136" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 2.431em;"></span></span><span style="position: absolute; top: -1.869em; left: 0.489em;"><span class="mi" id="MathJax-Span-137" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.015em;"></span></span></span></span><span class="mo" id="MathJax-Span-138" style="font-family: MathJax_Main; padding-left: 0.281em;">¡Ü</span><span class="msubsup" id="MathJax-Span-139" style="padding-left: 0.281em;"><span style="display: inline-block; position: relative; width: 1.46em; height: 0px;"><span style="position: absolute; clip: rect(1.807em, 1000em, 2.916em, -0.551em); top: -2.701em; left: 0.003em;"><span class="mn" id="MathJax-Span-140" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 2.708em;"></span></span><span style="position: absolute; top: -2.632em; left: 1.044em;"><span class="mn" id="MathJax-Span-141" style="font-size: 70.7%; font-family: MathJax_Main;">9</span><span style="display: inline-block; width: 0px; height: 2.223em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.708em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.218em; vertical-align: -0.282em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-23">1\leq a_i,b_i\leq 10^9</script>), denoting an bidirectional tunnel between the <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-24-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-142" style="width: 0.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.905em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.35em, 1000em, 1.321em, -0.621em); top: -0.967em; left: 0.003em;"><span class="mrow" id="MathJax-Span-143"><span class="msubsup" id="MathJax-Span-144"><span style="display: inline-block; position: relative; width: 0.905em; height: 0px;"><span style="position: absolute; clip: rect(1.807em, 1000em, 2.639em, -0.621em); top: -2.424em; left: 0.003em;"><span class="mi" id="MathJax-Span-145" style="font-family: MathJax_Math-italic;">u</span><span style="display: inline-block; width: 0px; height: 2.431em;"></span></span><span style="position: absolute; top: -1.869em; left: 0.558em;"><span class="mi" id="MathJax-Span-146" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.015em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.974em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.789em; vertical-align: -0.211em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-24">u_i</script>-th room and the <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-25-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-147" style="width: 0.905em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.35em, 1000em, 1.321em, -0.621em); top: -0.967em; left: 0.003em;"><span class="mrow" id="MathJax-Span-148"><span class="msubsup" id="MathJax-Span-149"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(1.807em, 1000em, 2.639em, -0.621em); top: -2.424em; left: 0.003em;"><span class="mi" id="MathJax-Span-150" style="font-family: MathJax_Math-italic;">v</span><span style="display: inline-block; width: 0px; height: 2.431em;"></span></span><span style="position: absolute; top: -1.869em; left: 0.489em;"><span class="mi" id="MathJax-Span-151" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.015em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.974em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.789em; vertical-align: -0.211em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-25">v_i</script>-th room, the length of which is either <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-26-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-152" style="width: 0.974em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.905em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.35em, 1000em, 1.321em, -0.621em); top: -0.967em; left: 0.003em;"><span class="mrow" id="MathJax-Span-153"><span class="msubsup" id="MathJax-Span-154"><span style="display: inline-block; position: relative; width: 0.905em; height: 0px;"><span style="position: absolute; clip: rect(1.807em, 1000em, 2.639em, -0.621em); top: -2.424em; left: 0.003em;"><span class="mi" id="MathJax-Span-155" style="font-family: MathJax_Math-italic;">a</span><span style="display: inline-block; width: 0px; height: 2.431em;"></span></span><span style="position: absolute; top: -1.869em; left: 0.558em;"><span class="mi" id="MathJax-Span-156" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.015em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.974em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.789em; vertical-align: -0.211em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-26">a_i</script> or <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-27-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-157" style="width: 0.905em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(0.073em, 1000em, 1.321em, -0.551em); top: -0.967em; left: 0.003em;"><span class="mrow" id="MathJax-Span-158"><span class="msubsup" id="MathJax-Span-159"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(1.529em, 1000em, 2.639em, -0.551em); top: -2.424em; left: 0.003em;"><span class="mi" id="MathJax-Span-160" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 2.431em;"></span></span><span style="position: absolute; top: -1.869em; left: 0.489em;"><span class="mi" id="MathJax-Span-161" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 2.015em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 0.974em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.004em; vertical-align: -0.211em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-27">b_i</script>.<br><br>It is guaranteed that the sum of all <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-28-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-162" style="width: 0.697em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.807em, 1000em, 2.639em, -0.621em); top: -2.424em; left: 0.003em;"><span class="mrow" id="MathJax-Span-163"><span class="mi" id="MathJax-Span-164" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.431em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.646em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-28">n</script> is at most <span class="MathJax_Preview"></span><span class="MathJax" id="MathJax-Element-29-Frame" role="textbox" aria-readonly="true" style=""><nobr><span class="math" id="MathJax-Span-165" style="width: 3.263em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.124em; height: 0px; font-size: 103%;"><span style="position: absolute; clip: rect(1.807em, 1000em, 2.916em, -0.551em); top: -2.701em; left: 0.003em;"><span class="mrow" id="MathJax-Span-166"><span class="mn" id="MathJax-Span-167" style="font-family: MathJax_Main;">200</span><span class="mspace" id="MathJax-Span-168" style="height: 0.003em; vertical-align: 0.003em; width: 0.142em; display: inline-block; overflow: hidden;"></span><span class="mn" id="MathJax-Span-169" style="font-family: MathJax_Main;">000</span></span><span style="display: inline-block; width: 0px; height: 2.708em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 0.861em; vertical-align: -0.068em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-29">200\,000</script>.</div><div class="panel_bottom">&nbsp;</div><br><div class="panel_title" align="left">Output</div><div class="panel_content">For each test case, output a single line containing an integer, the minimum possible length of the diameter.</div><div class="panel_bottom">&nbsp;</div><br><div class="panel_title" align="left">Sample Input</div><div class="panel_content"><pre><div style="word-wrap:break-word;White-space:Pre-wrap;width:inherit;font-family:Courier New,Courier,monospace;white-space:pre;">1
4 1
1 2 1 3
2 3 4 2
2 4 3 5</div></pre></div><div class="panel_bottom">&nbsp;</div><br><div class="panel_title" align="left">Sample Output</div><div class="panel_content"><pre><div style="word-wrap:break-word;White-space:Pre-wrap;width:inherit;font-family:Courier New,Courier,monospace;white-space:pre;">6</div></pre></div><div class="panel_bottom">&nbsp;</div><br><center style="font-size:15px;font-family:Arial;font-weight:bold;color:#1A5CC8"><a href="http://acm.hdu.edu.cn/contests/contest_statistic.php?cid=880&amp;pid=1007">Statistic</a>&nbsp;|&nbsp;<a href="http://acm.hdu.edu.cn/contests/contest_submit.php?cid=880&amp;pid=1007">Submit</a>&nbsp;|&nbsp;<a href="http://acm.hdu.edu.cn/contests/contest_listtopic.php?cid=880">Clarifications</a>&nbsp;|&nbsp;<a href="http://acm.hdu.edu.cn/contests/contest_show.php?cid=880">Back</a></center><br></div>
<div id="contest_footer">
	<div class="footer_link" style="width:15%;float:left;line-height:67px"><a href="http://acm.hdu.edu.cn/">Home</a> | <a href="http://acm.hdu.edu.cn/contests/contest_showproblem.php?pid=1007&amp;cid=880#top">Top</a></div>
	<div style="width:68%;float:left">
	Hangzhou Dianzi University Online Judge 3.0<br>
	Copyright &#169; 2005-2020 <a href="mailto:acm@hdu.edu.cn">HDU ACM Team</a>. All Rights Reserved.<br>
	<a href="http://acm.hdu.edu.cn/about_us/developer.php">Designer &amp; Developer </a> : <a>Wang Rongtao</a>&nbsp;<a>Lin Le</a>&nbsp;<a href="mailto:gjavac@gmail.com">GaoJie</a>&nbsp;<a href="mailto:gl8997@gmail.com">GanLu</a><br>
	<span class="pagerunstatus">Total 0.015600(s) query 30, Server time : 2020-07-30 09:53:25, Gzip enabled</span>	</div>
	<div class="footer_link" style="width:15%;float:right;line-height:67px">
		<a href="http://acm.hdu.edu.cn/admin">Administration</a>	
	</div>
</div></center>


<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Main, sans-serif;"></div></div></body></html>